[build]
command = "pnpm build"
publish = "dist"
functions = "netlify/functions"

# Route all API requests to the api.ts handler
[[rewrites]]
from = "/api/*"
to = "/.netlify/functions/api"

# Handle OPTIONS requests for CORS
[[redirects]]
from = "/api/*"
to = "/.netlify/functions/api"
status = 200
methods = ["OPTIONS"]

# SPA fallback for client-side routing (must be last)
# Only rewrite paths that don't match known file extensions
[[rewrites]]
from = "/*"
to = "/index.html"
conditions = { "Not" = [{ "Path" = ["/api/*"] }] }
